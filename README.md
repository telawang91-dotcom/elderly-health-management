# 🌟 智慧养老健康管理系统 - AI赋能老年人居家养老解决方案

![Python](https://img.shields.io/badge/Python-3.9%2B-blue)
![Flask](https://img.shields.io/badge/Flask-2.3.3-green)
![SQLAlchemy](https://img.shields.io/badge/SQLAlchemy-2.0.23-orange)
![Ollama](https://img.shields.io/badge/Ollama-Gemma3:4b-purple)
![License](https://img.shields.io/badge/License-MIT-yellow)

## 📋 项目概述

### 1.1 项目定位

本项目是一款 **AI大模型赋能的智慧养老健康管理系统**，聚焦老年人居家养老的核心痛点（健康数据监测、用药管理、紧急求助、健康咨询），通过「前端老年友好交互 + 后端AI智能分析 + 子女远程监控」的全链路设计，构建安全、便捷、智能的养老健康管理生态。

### 1.2 核心目标

- 解决老年人「健康数据记录难、用药易忘记、紧急情况难求助、健康疑问无专业解答」的痛点
- 实现子女「远程实时查看父母健康状态、接收异常预警、同步用药记录」的需求
- 以AI大模型为核心，提供个性化健康分析、饮食建议、专业医疗咨询服务
- 契合「AI赋能社会可持续发展」主题，推动养老服务数字化、智能化升级

### 1.3 适配场景

- 居家老年人自主使用（健康数据录入、用药提醒、紧急呼叫、健康咨询）
- 子女远程监控（查看父母健康档案、接收异常通知、导出健康报告）
- 养老院/社区养老机构批量管理（扩展场景，支持多老人账号统一管理）

## 🛠️ 技术栈详解

### 2.1 后端技术栈

| 技术/框架        | 版本   | 核心用途           | 选型理由                                                     |
| ---------------- | ------ | ------------------ | ------------------------------------------------------------ |
| Python           | 3.9+   | 核心开发语言       | 生态丰富，AI大模型、数据分析库支持完善                       |
| Flask            | 2.3.3  | Web应用框架        | 轻量级、易扩展，适合快速开发中小型Web系统                    |
| Flask-SQLAlchemy | 3.1.1  | ORM数据库映射      | 简化SQL操作，支持多种数据库（本项目用SQLite，可无缝切换MySQL） |
| LangChain-Ollama | 0.1.0  | 大模型调用框架     | 快速集成Ollama本地大模型，支持自定义Prompt工程               |
| Ollama           | 0.1.38 | 本地大模型运行环境 | 轻量级、部署简单，支持Gemma3、Llama3等主流模型，保护用户隐私（数据本地处理） |
| pdfkit           | 1.0.0  | PDF导出工具        | 支持HTML转PDF，实现健康周报批量导出                          |
| pandas           | 2.2.1  | 数据分析库         | 健康数据统计、Excel导出功能核心依赖                          |
| openpyxl         | 3.1.2  | Excel文件处理      | 支持.xlsx格式文件生成，适配老年人/子女数据备份需求           |

### 2.2 前端技术栈

| 技术/工具     | 核心用途       | 设计考量                                                     |
| ------------- | -------------- | ------------------------------------------------------------ |
| HTML5/CSS3    | 页面结构与样式 | 老年友好设计（大字体、大按钮、高对比度）                     |
| JavaScript    | 前端交互逻辑   | 实现密码显示/隐藏、语音朗读、表单校验、图表渲染              |
| ECharts       | 数据可视化     | 绘制血压/心率趋势图，直观展示健康变化                        |
| 浏览器原生API | 语音功能       | 基于`SpeechSynthesis`实现文本朗读，`SpeechRecognition`实现语音输入（无需第三方SDK） |

### 2.3 数据库

| 数据库 | 核心用途                                   | 优势                                               |
| ------ | ------------------------------------------ | -------------------------------------------------- |
| SQLite | 数据存储（用户信息、健康数据、用药记录等） | 无需额外部署，文件型数据库，适合快速启动和本地使用 |

### 2.4 工具类依赖

| 工具          | 用途                                              |
| ------------- | ------------------------------------------------- |
| wkhtmltopdf   | HTML转PDF核心依赖（pdfkit底层调用）               |
| python-dotenv | 环境变量管理（扩展功能，支持敏感配置分离）        |
| requests      | HTTP请求库（扩展功能，支持对接第三方硬件设备API） |

### 2.5 开发/部署工具

| 工具                | 用途                                       |
| ------------------- | ------------------------------------------ |
| VS Code             | 代码编辑                                   |
| Git                 | 版本控制                                   |
| Chrome/Edge         | 浏览器测试（语音功能优先支持这两款浏览器） |
| Windows/Linux/macOS | 跨平台部署（本项目已适配所有系统）         |

## 🧠 大模型应用详解

### 3.1 大模型选型

- 核心模型：Gemma3:4b（Ollama部署）
- 模型优势：轻量级（40亿参数）、响应速度快、中文支持良好、适合本地部署（无需GPU也可运行）
- 隐私保护：所有大模型交互均在本地完成，健康数据、咨询问题不泄露至第三方服务器

### 3.2 大模型核心应用场景

#### 场景1：健康数据智能分析

- **输入**：老年人血压、心率、血氧、血糖、体温等基础健康数据

- **Prompt工程**：限定输出格式（预警等级+健康分析+建议），语言专业且易懂（适配老年人认知水平）

- **输出**：健康预警等级（正常/轻度异常/重度异常）、个性化健康分析、饮食建议

- **示例Prompt**：

  ```python
  prompt = f"""你是三甲医院老年病科主任医师，分析以下老年人健康数据，严格按【{warning_level}】等级输出，200字内：
  血压{high_bp}/{low_bp}mmHg，心率{heart_rate}次/分，血氧{blood_oxygen}%，空腹血糖{fasting}，餐后{postprandial}，体温{temperature}℃。
  输出格式：先写【预警等级】，换行写【健康分析与建议】，语言专业简洁易懂。"""
  ```

#### 场景2：健康咨询问答

- **输入**：老年人健康相关问题（如“高血压能吃鸡蛋吗？”“失眠怎么办？”）
- **Prompt工程**：限定角色（老年病科副主任医师）、回答风格（通俗易懂、避免专业术语、实用建议）、字数限制（300字内）
- **输出**：针对性健康解答，结合居家养老场景给出可操作建议

#### 场景3：语音交互增强（扩展功能）

- 语音输入提问：基于浏览器`SpeechRecognition`API将语音转文字，调用大模型生成答案后，通过`SpeechSynthesis`API朗读回答
- 适用人群：不擅长打字的老年人，实现“说话提问→语音回答”全流程无键盘操作

## 📊 系统架构设计

### 4.1 整体架构

```
graph TD
    A[前端交互层] --> B[后端服务层]
    B --> C[数据存储层]
    B --> D[AI大模型层]
    
    subgraph A[前端交互层]
        A1[老年友好Web界面]
        A2[数据可视化模块]
        A3[语音交互模块]
        A4[表单交互模块]
    end
    
    subgraph B[后端服务层]
        B1[用户管理模块]
        B2[健康数据管理模块]
        B3[用药管理模块]
        B4[紧急呼叫模块]
        B5[AI交互模块]
        B6[数据导出模块]
        B7[通知推送模块]
    end
    
    subgraph C[数据存储层]
        C1[SQLite数据库]
        C2[系统日志文件]
        C3[导出文件存储]
    end
    
    subgraph D[AI大模型层]
        D1[Ollama运行环境]
        D2[Gemma3:4b模型]
        D3[Prompt工程模块]
    end
```

### 4.2 核心数据流

1. 健康数据录入流程：
   前端表单提交 → 后端数据校验 → 大模型健康分析 → 数据存储 → 异常情况触发子女通知
2. 健康咨询流程：
   前端输入提问（文字/语音） → 后端Prompt构造 → 调用Gemma3模型 → 结果返回前端 → 支持语音朗读
3. 紧急呼叫流程：
   老人点击呼叫按钮 → 后端查询绑定子女 → 生成紧急通知 → 子女账号接收未读提醒

## 🚀 核心功能模块

### 5.1 用户管理模块

| 功能点       | 详细描述                                                     | 技术实现                                        |
| ------------ | ------------------------------------------------------------ | ----------------------------------------------- |
| 账号注册     | 支持“老人”“子女”双角色注册，老人账号可填写紧急联系人         | Flask-SQLAlchemy用户表设计，用户名唯一校验      |
| 登录认证     | 支持账号密码登录、“记住我”自动填充功能                       | Flask-Session会话管理，本地存储账号密码（可选） |
| 角色权限控制 | 老人账号：录入数据、添加用药、紧急呼叫；子女账号：查看数据、接收通知 | 会话中存储角色信息，路由层面权限校验            |
| 账号绑定     | 老人账号可绑定多个子女账号，子女可查看绑定老人数据           | UserBind关联表设计，支持多对多绑定              |

### 5.2 健康数据管理模块

| 功能点         | 详细描述                                                     | 技术实现                                   |
| -------------- | ------------------------------------------------------------ | ------------------------------------------ |
| 健康数据录入   | 支持血压、心率、血氧、血糖、体重、体温等8项核心数据录入，带正常范围提示 | 前端表单校验（数值范围限制），后端类型转换 |
| AI健康分析     | 录入数据后自动调用Gemma3模型生成健康分析、预警等级、饮食建议 | LangChain-Ollama调用大模型，自定义Prompt   |
| 异常预警通知   | 重度异常数据自动推送通知给绑定子女                           | Notice表存储通知，子女登录时显示未读提醒   |
| 健康档案查看   | 分页展示历史健康数据，支持按时间倒序排列                     | Flask分页查询，前端分页控件                |
| 健康数据可视化 | 展示近7天血压/心率趋势图，直观查看健康变化                   | ECharts折线图，后端统计7天数据             |

### 5.3 用药管理模块

| 功能点       | 详细描述                                             | 技术实现                                |
| ------------ | ---------------------------------------------------- | --------------------------------------- |
| 用药记录添加 | 支持录入药名、剂量、服药时间、提醒时间、过期日期     | MedicineRecord表设计，日期格式校验      |
| 服药状态标记 | 支持单条记录标记“已服药”、一键标记全部已服药         | 后端更新take_status字段，批量SQL操作    |
| 服药定时提醒 | 每天固定时间（08:00/12:00/18:00/20:00）弹窗+语音提醒 | 前端定时器，结合SpeechSynthesis语音播报 |
| 药品过期提醒 | 过期/即将过期药品自动提醒，避免服用过期药            | 后端计算过期天数，前端展示红色预警      |
| 用药记录查询 | 分页展示历史用药记录，支持子女查看                   | 关联username查询，分页展示              |

### 5.4 紧急呼叫模块

| 功能点       | 详细描述                                 | 技术实现                           |
| ------------ | ---------------------------------------- | ---------------------------------- |
| 紧急呼叫触发 | 老人一键点击“紧急呼叫”按钮，快速联系子女 | 前端异步请求，后端生成紧急通知     |
| 多子女通知   | 绑定多个子女时，全部推送紧急求助信息     | 批量查询绑定子女，批量创建通知记录 |
| 呼叫结果反馈 | 呼叫成功/失败弹窗提示，支持语音播报      | 前端异步回调处理，语音播报结果     |

### 5.5 AI健康咨询模块

| 功能点               | 详细描述                                                | 技术实现                              |
| -------------------- | ------------------------------------------------------- | ------------------------------------- |
| 文字提问             | 支持输入健康相关问题，获取专业解答                      | 后端构造Prompt，调用Gemma3模型        |
| 预设常见问题         | 内置5个高频问题（高血压、失眠、糖尿病等），点击直接填充 | 前端JS函数填充输入框，提升操作便捷性  |
| 语音朗读解答         | 支持朗读咨询结果，适合视力不佳的老年人                  | 浏览器SpeechSynthesis API             |
| 语音输入提问（扩展） | 支持语音转文字提问，无需打字                            | 浏览器SpeechRecognition API，中文识别 |

### 5.6 数据导出模块

| 功能点            | 详细描述                                        | 技术实现                                 |
| ----------------- | ----------------------------------------------- | ---------------------------------------- |
| 健康周报PDF导出   | 导出近7天健康数据统计、异常记录、服药情况       | pdfkit将HTML模板转为PDF，支持自定义样式  |
| 健康数据Excel导出 | 导出全部健康数据，支持备份、打印给医生看        | pandas数据框生成，openpyxl写入Excel文件  |
| 子女代导出        | 子女可导出绑定老人的健康报告/数据，方便就医携带 | 关联elder_username查询数据，导出逻辑复用 |

### 5.7 其他辅助模块

| 功能点       | 详细描述                                         | 技术实现                           |
| ------------ | ------------------------------------------------ | ---------------------------------- |
| 日常活动记录 | 支持录入睡眠时长、运动时长、活动备注             | ActivityRecord表设计，数值范围校验 |
| 健康科普知识 | 提供高血压、糖尿病、通用健康管理知识             | 静态HTML展示，支持语音朗读全文     |
| 系统操作日志 | 记录用户登录、数据录入、导出等操作，便于问题排查 | 日志文件写入，前端格式化展示       |
| 老年友好设计 | 大字体（19px+）、大按钮、高对比度、操作提示清晰  | CSS样式统一设计，避免复杂交互      |

## 📝 部署步骤

### 6.1 环境准备

#### 6.1.1 操作系统要求

- Windows 10/11、Linux（Ubuntu 20.04+）、macOS 12+（跨平台支持）

#### 6.1.2 依赖安装

1. Python 3.9+ 安装：
   - 下载地址：https://www.python.org/downloads/
   - 验证：`python --version`（Windows）/ `python3 --version`（Linux/macOS）

2. Ollama 安装与模型部署：
   - 下载地址：https://ollama.com/download
   - 安装后启动Ollama服务（后台运行）
   - 拉取Gemma3:4b模型：打开终端执行 `ollama pull gemma3:4b`
   - 验证：`ollama list` 查看是否存在gemma3:4b模型

3. wkhtmltopdf 安装（PDF导出必需）：
   - 下载地址：https://wkhtmltopdf.org/downloads.html
   - 安装后需配置环境变量，或在代码中指定路径（`WKHTMLTOPDF_PATH`）

### 6.2 项目部署

1. 克隆项目代码：

   ```bash
   git clone https://github.com/your-username/elderly-health-management.git
   cd elderly-health-management
   ```

2. 创建虚拟环境（可选但推荐）：

   ```bash
   # Windows
   python -m venv venv
   venv\Scripts\activate
   
   # Linux/macOS
   python3 -m venv venv
   source venv/bin/activate
   ```

3. 安装Python依赖：

   ```bash
   pip install -r requirements.txt
   ```

   - requirements.txt 内容：

     ```
     flask==2.3.3
     flask-sqlalchemy==3.1.1
     langchain-ollama==0.1.0
     pdfkit==1.0.0
     pandas==2.2.1
     openpyxl==3.1.2
     requests==2.31.0
     ```

4. 配置项目：

   - 打开 `flask_web_final.py`，修改 `WKHTMLTOPDF_PATH` 为你的实际安装路径：

     ```python
     WKHTMLTOPDF_PATH = r'C:\Program Files\wkhtmltopdf\bin\wkhtmltopdf.exe'  # Windows示例
     # WKHTMLTOPDF_PATH = '/usr/local/bin/wkhtmltopdf'  # Linux示例
     # WKHTMLTOPDF_PATH = '/Applications/wkhtmltopdf.app/Contents/MacOS/wkhtmltopdf'  # macOS示例
     ```

5. 启动项目：

   ```bash
   python flask_web_final.py
   ```

6. 访问系统：

   - 打开浏览器，输入地址：`http://127.0.0.1:5000`
   - 首次启动会自动创建SQLite数据库文件（`elderly_care_prod.db`）

### 6.3 常见部署问题排查

1. Ollama模型启动失败：
   - 确保Ollama服务已启动（后台进程）
   - 模型拉取失败可更换网络，或手动下载模型文件
2. PDF导出失败：
   - 检查wkhtmltopdf路径是否正确
   - 检查系统是否安装了依赖（Linux需安装`libxrender1`等依赖）
3. 语音功能无法使用：
   - 推荐使用Chrome/Edge浏览器，其他浏览器可能不支持SpeechRecognition/SpeechSynthesis API
4. 端口占用：
   - 若5000端口被占用，修改`app.run(port=5001)`（或其他空闲端口）

## 📖 使用指南

### 7.1 老人账号使用流程

1. 注册账号：选择“老人”角色，填写用户名、密码、紧急联系人（可选）
2. 登录系统：勾选“记住我”，下次无需重复输入账号密码
3. 绑定子女：在“账号绑定”模块输入子女用户名，完成绑定
4. 日常操作：
   - 录入健康数据：填写血压、心率等数据，提交后查看AI分析
   - 添加用药记录：录入药品信息，设置提醒时间
   - 紧急呼叫：遇到紧急情况点击“紧急呼叫”按钮，联系子女
   - 健康咨询：输入问题或点击预设问题，获取专业解答，支持语音朗读

### 7.2 子女账号使用流程

1. 注册账号：选择“子女”角色，填写用户名、密码
2. 等待绑定：让老人在其账号中绑定你的用户名
3. 查看数据：
   - 登录后可查看绑定老人的健康档案、用药记录
   - 接收异常通知：老人健康数据重度异常时，会收到未读提醒
   - 导出报告：导出老人健康周报（PDF）、健康数据（Excel），方便就医使用

## 🌟 项目亮点

### 8.1 技术亮点

1. **本地大模型部署**：基于Ollama+Gemma3:4b，健康数据、咨询问题本地处理，保护用户隐私，无需网络也可使用核心功能
2. **老年友好设计**：大字体、大按钮、高对比度、简化操作流程，适配老年人视力、操作习惯
3. **全链路语音支持**：文本朗读、语音输入、语音提醒，覆盖视力不佳、不擅长打字的老年人
4. **轻量级部署**：无需复杂服务器配置，本地即可运行，适合家庭使用
5. **可扩展性强**：支持切换数据库（SQLite→MySQL）、更换大模型（Gemma3→Llama3）、扩展硬件对接（血压计、血糖仪API）

### 8.2 社会价值亮点

1. **解决实际养老痛点**：聚焦健康管理、用药提醒、紧急求助等核心需求，提升老年人居家养老安全性、便捷性
2. **降低养老成本**：减少子女陪护压力，无需专业人员实时看护，通过技术手段实现“远程尽孝”
3. **AI赋能可持续发展**：将大模型技术落地到养老场景，推动养老服务数字化、智能化，契合“AI赋能社会可持续发展”主题
4. **普适性强**：无需高端设备，普通电脑/平板即可使用，适合广大老年人群体

## 📈 后续优化方向

1. **硬件设备对接**：接入智能血压计、血糖仪等设备，实现健康数据自动同步，无需手动录入
2. **大模型微调**：基于老年人健康数据、常见疾病案例微调模型，提升健康分析、咨询解答的精准度
3. **多语言支持**：增加粤语、方言语音识别/朗读，适配南方地区老年人
4. **社区健康科普**：增加健康科普推送功能，定期推送老年人健康知识、节气养生建议
5. **批量管理功能**：增加管理员账号，支持养老院/社区批量管理老人账号，统计健康数据
6. **视频通话集成**：整合WebRTC实现紧急呼叫时视频通话，让子女直观了解老人情况
7. **健康风险预测**：基于历史健康数据，通过大模型预测潜在健康风险，提前预警（如高血压并发症风险）

## 📄 许可证

本项目采用 **MIT License** 开源，允许个人/商业使用、修改、分发，无需授权，但需保留原作者版权声明。

## 📞 联系方式

- 项目作者：王新峰
- 院校：深圳大学电子信息工程专业（研二）
- 邮箱：1822527080@qq.com
- GitHub仓库：https://github.com/telawang91-dotcom/elderly-health-management

---

## 🎯 项目适配面试重点

本项目完美契合“AI赋能社会可持续发展”主题：

1. **技术落地能力**：将大模型、Web开发、数据分析等技术整合，落地到养老实际场景
2. **用户需求洞察**：深入理解老年人、子女的核心痛点，设计老年友好的交互体验
3. **社会价值导向**：聚焦养老这一社会热点问题，用技术解决实际需求，推动可持续发展
4. **技术栈完整性**：覆盖前端、后端、AI大模型、数据库、数据分析等全链路技术，体现综合能力
5. **可扩展性**：项目架构设计合理，支持功能扩展、硬件对接、场景延伸，体现工程化思维

欢迎各位开发者Star、Fork、PR，一起完善项目，为智慧养老贡献力量！
